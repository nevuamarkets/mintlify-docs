{
  "openapi": "3.0.0",
  "servers": [
    {
      "url": "https://api.nevua.markets",
      "description": "Production"
    }
  ],
  "info": {
    "title": "Nevua Markets API",
    "version": "0.0.1",
    "license": {
      "name": "ISC",
      "url": "https://opensource.org/licenses/ISC"
    }
  },
  "components": {
    "schemas": {
      "SearchV2JSONRequest": {
        "type": "object",
        "properties": {
          "keyphrases": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SearchKeyphrase"
            }
          },
          "searchMatchOperator": {
            "$ref": "#/components/schemas/SearchMatchOperator"
          },
          "partial": {
            "type": "boolean"
          }
        },
        "additionalProperties": false,
        "required": [
          "keyphrases",
          "partial",
          "searchMatchOperator"
        ]
      },
      "SearchKeyphrase": {
        "type": "object",
        "properties": {
          "text": {
            "type": "string"
          },
          "include": {
            "type": "boolean"
          },
          "type": {
            "enum": [
              "exclude",
              "include"
            ],
            "type": "string"
          }
        },
        "additionalProperties": false,
        "required": [
          "text"
        ]
      },
      "SearchMatchOperator": {
        "type": "string",
        "enum": [
          "AND",
          "OR"
        ]
      },
      "SearchJSONResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/MatchingEvent"
        }
      },
      "MatchingEvent": {
        "type": "object",
        "properties": {
          "id": {
            "description": "The event ID",
            "type": "string"
          },
          "title": {
            "description": "The event title",
            "type": "string"
          },
          "slug": {
            "description": "The event slug",
            "type": "string"
          },
          "image": {
            "description": "The event image",
            "type": "string"
          },
          "type": {
            "description": "The event type",
            "enum": [
              "event",
              "market"
            ],
            "type": "string"
          },
          "markets": {
            "description": "The markets associated with the event",
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "description": "The market ID",
                  "type": "string"
                },
                "image": {
                  "description": "The market image",
                  "type": "string"
                },
                "question": {
                  "description": "The market question",
                  "type": "string"
                },
                "outcomes": {
                  "description": "Outcomes and outcome prices",
                  "type": "string"
                },
                "outcomePrices": {
                  "type": "string"
                },
                "nevuaSVGLink": {
                  "description": "SVG link",
                  "type": "string"
                }
              },
              "additionalProperties": false,
              "required": [
                "id",
                "image",
                "nevuaSVGLink",
                "outcomePrices",
                "outcomes",
                "question"
              ]
            }
          }
        },
        "additionalProperties": false,
        "required": [
          "id",
          "image",
          "markets",
          "slug",
          "title",
          "type"
        ]
      },
      "CreateWatchlistScopeSubscriptionJSONRequest": {
        "type": "object",
        "properties": {
          "watchlistId": {
            "type": "string"
          },
          "subscriptionTypeConfig": {
            "$ref": "#/components/schemas/SubscriptionTypeConfig"
          },
          "channels": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookNotificationChannel"
            }
          }
        },
        "additionalProperties": false,
        "required": [
          "channels",
          "subscriptionTypeConfig",
          "watchlistId"
        ]
      },
      "SubscriptionTypeConfig": {
        "anyOf": [
          {
            "$ref": "#/components/schemas/CrossingSubscriptionTypeConfig"
          },
          {
            "$ref": "#/components/schemas/CrossingUpSubscriptionTypeConfig"
          },
          {
            "$ref": "#/components/schemas/CrossingDownSubscriptionTypeConfig"
          },
          {
            "$ref": "#/components/schemas/CrossingStepSubscriptionTypeConfig"
          },
          {
            "$ref": "#/components/schemas/GreaterThanSubscriptionTypeConfig"
          },
          {
            "$ref": "#/components/schemas/LessThanSubscriptionTypeConfig"
          },
          {
            "$ref": "#/components/schemas/EventAndMarketOpenStatusChangesSubscriptionTypeConfig"
          }
        ]
      },
      "CrossingSubscriptionTypeConfig": {
        "title": "Lekkas\n\nThis is a cross subscription type config",
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/SubscriptionType.CROSSING"
          },
          "config": {
            "$ref": "#/components/schemas/SubscriptionConfig"
          }
        },
        "additionalProperties": false,
        "required": [
          "config",
          "type"
        ]
      },
      "SubscriptionType.CROSSING": {
        "type": "string",
        "enum": [
          "Crossing"
        ]
      },
      "SubscriptionConfig": {
        "type": "object",
        "properties": {
          "params": {
            "$ref": "#/components/schemas/SubscriptionConfig.T"
          }
        },
        "additionalProperties": false,
        "required": [
          "params"
        ]
      },
      "CrossAnyParams": {
        "type": "object",
        "properties": {
          "threshold_percent": {
            "type": "number"
          }
        },
        "additionalProperties": false,
        "required": [
          "threshold_percent"
        ]
      },
      "SubscriptionConfig.T": {
        "$ref": "#/components/schemas/CrossAnyParams"
      },
      "CrossingUpSubscriptionTypeConfig": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/SubscriptionType.CROSSING_UP"
          },
          "config": {
            "$ref": "#/components/schemas/SubscriptionConfig_1"
          }
        },
        "additionalProperties": false,
        "required": [
          "config",
          "type"
        ]
      },
      "SubscriptionType.CROSSING_UP": {
        "type": "string",
        "enum": [
          "Crossing Up"
        ]
      },
      "SubscriptionConfig_1": {
        "type": "object",
        "properties": {
          "params": {
            "$ref": "#/components/schemas/SubscriptionConfig.T_1"
          }
        },
        "additionalProperties": false,
        "required": [
          "params"
        ]
      },
      "CrossUpParams": {
        "type": "object",
        "properties": {
          "threshold_percent": {
            "type": "number"
          }
        },
        "additionalProperties": false,
        "required": [
          "threshold_percent"
        ]
      },
      "SubscriptionConfig.T_1": {
        "$ref": "#/components/schemas/CrossUpParams"
      },
      "CrossingDownSubscriptionTypeConfig": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/SubscriptionType.CROSSING_DOWN"
          },
          "config": {
            "$ref": "#/components/schemas/SubscriptionConfig_2"
          }
        },
        "additionalProperties": false,
        "required": [
          "config",
          "type"
        ]
      },
      "SubscriptionType.CROSSING_DOWN": {
        "type": "string",
        "enum": [
          "Crossing Down"
        ]
      },
      "SubscriptionConfig_2": {
        "type": "object",
        "properties": {
          "params": {
            "$ref": "#/components/schemas/SubscriptionConfig.T_2"
          }
        },
        "additionalProperties": false,
        "required": [
          "params"
        ]
      },
      "CrossDownParams": {
        "type": "object",
        "properties": {
          "threshold_percent": {
            "type": "number"
          }
        },
        "additionalProperties": false,
        "required": [
          "threshold_percent"
        ]
      },
      "SubscriptionConfig.T_2": {
        "$ref": "#/components/schemas/CrossDownParams"
      },
      "CrossingStepSubscriptionTypeConfig": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/SubscriptionType.CROSSING_STEP"
          },
          "config": {
            "$ref": "#/components/schemas/SubscriptionConfig_3"
          }
        },
        "additionalProperties": false,
        "required": [
          "config",
          "type"
        ]
      },
      "SubscriptionType.CROSSING_STEP": {
        "type": "string",
        "enum": [
          "Crossing Step"
        ]
      },
      "SubscriptionConfig_3": {
        "type": "object",
        "properties": {
          "params": {
            "$ref": "#/components/schemas/SubscriptionConfig.T_3"
          }
        },
        "additionalProperties": false,
        "required": [
          "params"
        ]
      },
      "CrossStepParams": {
        "type": "object",
        "properties": {
          "threshold_percent": {
            "type": "number"
          }
        },
        "additionalProperties": false,
        "required": [
          "threshold_percent"
        ]
      },
      "SubscriptionConfig.T_3": {
        "$ref": "#/components/schemas/CrossStepParams"
      },
      "GreaterThanSubscriptionTypeConfig": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/SubscriptionType.GREATER_THAN"
          },
          "config": {
            "$ref": "#/components/schemas/SubscriptionConfig_4"
          }
        },
        "additionalProperties": false,
        "required": [
          "config",
          "type"
        ]
      },
      "SubscriptionType.GREATER_THAN": {
        "type": "string",
        "enum": [
          "Greater Than"
        ]
      },
      "SubscriptionConfig_4": {
        "type": "object",
        "properties": {
          "params": {
            "$ref": "#/components/schemas/SubscriptionConfig.T_4"
          }
        },
        "additionalProperties": false,
        "required": [
          "params"
        ]
      },
      "GreaterThanParams": {
        "type": "object",
        "properties": {
          "threshold_percent": {
            "type": "number"
          }
        },
        "additionalProperties": false,
        "required": [
          "threshold_percent"
        ]
      },
      "SubscriptionConfig.T_4": {
        "$ref": "#/components/schemas/GreaterThanParams"
      },
      "LessThanSubscriptionTypeConfig": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/SubscriptionType.LESS_THAN"
          },
          "config": {
            "$ref": "#/components/schemas/SubscriptionConfig_5"
          }
        },
        "additionalProperties": false,
        "required": [
          "config",
          "type"
        ]
      },
      "SubscriptionType.LESS_THAN": {
        "type": "string",
        "enum": [
          "Less Than"
        ]
      },
      "SubscriptionConfig_5": {
        "type": "object",
        "properties": {
          "params": {
            "$ref": "#/components/schemas/SubscriptionConfig.T_5"
          }
        },
        "additionalProperties": false,
        "required": [
          "params"
        ]
      },
      "LessThanParams": {
        "type": "object",
        "properties": {
          "threshold_percent": {
            "type": "number"
          }
        },
        "additionalProperties": false,
        "required": [
          "threshold_percent"
        ]
      },
      "SubscriptionConfig.T_5": {
        "$ref": "#/components/schemas/LessThanParams"
      },
      "EventAndMarketOpenStatusChangesSubscriptionTypeConfig": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/SubscriptionType.EVENT_AND_MARKET_OPEN_STATUS_CHANGES"
          },
          "config": {
            "$ref": "#/components/schemas/SubscriptionConfig_6"
          }
        },
        "additionalProperties": false,
        "required": [
          "config",
          "type"
        ]
      },
      "SubscriptionType.EVENT_AND_MARKET_OPEN_STATUS_CHANGES": {
        "type": "string",
        "enum": [
          "New or closed events and markets"
        ]
      },
      "SubscriptionConfig_6": {
        "type": "object",
        "properties": {
          "params": {
            "$ref": "#/components/schemas/SubscriptionConfig.T_6"
          }
        },
        "additionalProperties": false,
        "required": [
          "params"
        ]
      },
      "EmptyParams": {
        "type": "object",
        "additionalProperties": false
      },
      "SubscriptionConfig.T_6": {
        "$ref": "#/components/schemas/EmptyParams"
      },
      "WebhookNotificationChannel": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/NotificationChannelType.WEBHOOK"
          },
          "settings": {
            "type": "object",
            "properties": {
              "webhookUrl": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "required": [
              "webhookUrl"
            ]
          }
        },
        "additionalProperties": false,
        "required": [
          "settings",
          "type"
        ]
      },
      "NotificationChannelType.WEBHOOK": {
        "type": "string",
        "enum": [
          "Webhook"
        ]
      },
      "CreateWatchlistScopeSubscriptionJSONResponse": {
        "type": "object",
        "properties": {
          "subscriptions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SubscriptionResponse"
            }
          }
        },
        "additionalProperties": false,
        "required": [
          "subscriptions"
        ]
      },
      "GetSubscriptionsJSONResponse": {
        "type": "object",
        "properties": {
          "subscriptions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SubscriptionResponse"
            }
          }
        },
        "additionalProperties": false,
        "required": [
          "subscriptions"
        ]
      },
      "SubscriptionResponse": {
        "type": "object",
        "properties": {
          "watchlistId": {
            "type": "string"
          },
          "watchlistName": {
            "type": "string"
          },
          "subscriptionId": {
            "type": "string"
          },
          "eventTitle": {
            "type": "string"
          },
          "eventId": {
            "type": "string"
          },
          "marketQuestion": {
            "type": "string"
          },
          "marketId": {
            "type": "string"
          },
          "subscriptionScope": {
            "$ref": "#/components/schemas/SubscriptionScope"
          },
          "subscriptionTypeConfig": {
            "$ref": "#/components/schemas/SubscriptionTypeConfig"
          },
          "createdAt": {
            "type": "string"
          },
          "expiresAt": {
            "type": "string",
            "nullable": true
          },
          "updatedAt": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/SubscriptionStatus"
          },
          "triggerType": {
            "$ref": "#/components/schemas/TriggerType"
          },
          "triggerInterval": {
            "$ref": "#/components/schemas/TriggerInterval"
          },
          "triggerCount": {
            "type": "number"
          },
          "lastTriggeredAt": {
            "type": "string",
            "nullable": true
          },
          "channels": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NotificationChannel"
            }
          }
        },
        "additionalProperties": false,
        "required": [
          "channels",
          "createdAt",
          "expiresAt",
          "status",
          "subscriptionId",
          "subscriptionScope",
          "subscriptionTypeConfig",
          "triggerType",
          "watchlistId",
          "watchlistName"
        ]
      },
      "SubscriptionScope": {
        "type": "string",
        "enum": [
          "Watchlist",
          "Event",
          "Market"
        ]
      },
      "SubscriptionStatus": {
        "type": "object",
        "properties": {
          "enabled": {
            "type": "boolean"
          },
          "reason": {
            "$ref": "#/components/schemas/SubscriptionStatusReason"
          }
        },
        "additionalProperties": false,
        "required": [
          "enabled",
          "reason"
        ]
      },
      "SubscriptionStatusReason": {
        "type": "string",
        "enum": [
          "Created",
          "Updated",
          "Triggered",
          "Paused by user",
          "Restarted by user",
          "Event closed",
          "Market closed"
        ]
      },
      "TriggerType": {
        "type": "string",
        "enum": [
          "One Time",
          "Recurring"
        ]
      },
      "TriggerInterval": {
        "enum": [
          "12h",
          "24h",
          "30m",
          "5m",
          "60m",
          "6h"
        ],
        "type": "string"
      },
      "NotificationChannel": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/NotificationChannelType"
          },
          "settings": {
            "type": "object",
            "properties": {
              "telegramChatId": {
                "type": "number"
              },
              "webhookUrl": {
                "type": "string"
              },
              "discordWebhookUrl": {
                "type": "string"
              }
            },
            "additionalProperties": false
          },
          "status": {
            "enum": [
              "BLOCKED_BY_USER",
              "FAILED",
              "PENDING",
              "READ",
              "SENT"
            ],
            "type": "string"
          }
        },
        "additionalProperties": false,
        "required": [
          "type"
        ]
      },
      "NotificationChannelType": {
        "type": "string",
        "enum": [
          "In App",
          "Webhook",
          "Discord",
          "Telegram"
        ]
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      },
      "apiKey": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-KEY"
      }
    }
  },
  "security": [],
  "paths": {
    "/v2/search": {
      "post": {
        "operationId": "searchEvents",
        "security": [
          {
            "apiKey": []
          }
        ],
        "summary": "Search API",
        "description": "Search API for events using structured keyphrases\n**Authentication is optional.**\n",
        "tags": [
          "Search API"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchV2JSONRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful search response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SearchJSONResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/subscriptions/create/watchlist": {
      "post": {
        "operationId": "createWatchlistSubscription",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "Create a watchlist-scoped subscription",
        "description": "Creates a subscription that monitors all markets in a watchlist for the specified trigger conditions. \nThis is a simplified endpoint specifically for watchlist-scoped subscriptions that only accepts webhook notification channels.\n",
        "tags": [
          "Subscriptions"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateWatchlistScopeSubscriptionJSONRequest"
              },
              "examples": {
                "event_status_changes": {
                  "summary": "New or closed events and markets",
                  "value": {
                    "watchlistId": "507f1f77bcf86cd799439011",
                    "subscriptionTypeConfig": {
                      "type": "New or closed events and markets",
                      "config": {
                        "params": {}
                      }
                    },
                    "channels": [
                      {
                        "type": "Webhook",
                        "settings": {
                          "webhookUrl": "https://your-webhook-endpoint.com/status-changes"
                        }
                      }
                    ]
                  }
                },
                "crossing_alert": {
                  "summary": "Crossing threshold alert",
                  "value": {
                    "watchlistId": "507f1f77bcf86cd799439011",
                    "subscriptionTypeConfig": {
                      "type": "Crossing",
                      "config": {
                        "params": {
                          "threshold_percent": 50
                        }
                      }
                    },
                    "channels": [
                      {
                        "type": "Webhook",
                        "settings": {
                          "webhookUrl": "https://your-webhook-endpoint.com/alerts"
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Subscription created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateWatchlistScopeSubscriptionJSONResponse"
                },
                "examples": {
                  "success": {
                    "summary": "Successful subscription creation",
                    "value": {
                      "subscriptions": [
                        {
                          "watchlistId": "507f1f77bcf86cd799439011",
                          "watchlistName": "Election Markets",
                          "subscriptionId": "507f191e810c19729de860ea",
                          "subscriptionScope": "Watchlist",
                          "subscriptionTypeConfig": {
                            "type": "New or closed events and markets",
                            "config": {
                              "params": {}
                            }
                          },
                          "createdAt": "2024-09-26T10:30:00.000Z",
                          "expiresAt": null,
                          "updatedAt": null,
                          "status": {
                            "enabled": true,
                            "reason": "Created"
                          },
                          "triggerType": "Recurring",
                          "triggerInterval": "30m",
                          "triggerCount": 0,
                          "lastTriggeredAt": null,
                          "channels": [
                            {
                              "type": "Webhook",
                              "settings": {
                                "webhookUrl": "https://your-webhook-endpoint.com/status-changes"
                              }
                            }
                          ]
                        }
                      ]
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - validation error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                },
                "examples": {
                  "no_channels": {
                    "summary": "No notification channels provided",
                    "value": {
                      "error": "No channels found for subscription"
                    }
                  },
                  "watchlist_not_found": {
                    "summary": "Watchlist not found or doesn't belong to user",
                    "value": {
                      "error": "Watchlist not found"
                    }
                  },
                  "duplicate_event_status_subscription": {
                    "summary": "Duplicate event status subscription",
                    "value": {
                      "error": "Only one EVENT_AND_MARKET_OPEN_STATUS_CHANGES subscription is allowed per watchlist"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing authentication token",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "User not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                },
                "examples": {
                  "user_not_found": {
                    "summary": "User not found",
                    "value": {
                      "error": "User not found"
                    }
                  }
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                },
                "examples": {
                  "creation_failed": {
                    "summary": "Failed to create subscription",
                    "value": {
                      "error": "Failed to create subscription"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "tags": []
}