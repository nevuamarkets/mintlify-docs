---
title: 'Webhooks'
description: ''
---

This document describes the webhook notification schemas that are sent when subscription alerts are triggered for the `/subscriptions` endpoint.

## Overview

When you create a subscription with webhook channels configured, Nevua Markets will send HTTP POST requests to your configured webhook URLs when the subscription conditions are met. There are two types of notifications:

1. **Price Notifications** - Sent when price-based alert conditions are met (e.g., crossing thresholds)
2. **Event Status Notifications** - Sent when event or market status changes occur (e.g., new events created, markets closed)

## Price Notification Schema

This schema is used for all price-based alert notifications.

#### Properties

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `type` | `"price_notification"` | ✅ | The notification type |
| `createdAt` | `string` (ISO 8601) | ✅ | When the notification was created |
| `subscriptionId` | `string` | ✅ | The ID of the subscription that triggered this notification |
| `watchlistId` | `string` | ✅ | The ID of the watchlist being monitored |
| `watchlistName` | `string` | ✅ | The name of the watchlist |
| `eventId` | `string` | ✅ | The Polymarket event ID |
| `eventTitle` | `string` | ✅ | The title of the event |
| `marketId` | `string` | ✅ | The Polymarket market ID |
| `marketQuestion` | `string` | ✅ | The market question/title |
| `polymarketSlug` | `string` | ✅ | The Polymarket URL slug for this event |
| `clobTokenId` | `string` | ✅ | The CLOB token identifier |
| `subscriptionScope` | `"Watchlist" \| "Event" \| "Market"` | ✅ | The scope of the subscription |
| `subscriptionTypeConfig` | `object` | ✅ | Configuration details for the subscription type |
| `triggerType` | `"One Time" \| "Recurring"` | ✅ | Whether this is a one-time or recurring trigger |
| `detectedValue` | `number` | ✅ | The price/percentage value that triggered the alert |
| `detectedAt` | `string` (ISO 8601) | ✅ | When the condition was detected |
| `detectedAtMs` | `number` | ✅ | Detection timestamp in milliseconds |
| `sentFromPolymarketAtMs` | `number` | ✅ | When the data was received from Polymarket (milliseconds) |
| `title` | `string` | ❌ | Optional notification title |
| `message` | `string` | ❌ | Optional notification message |
| `sentToUserAtMs` | `number` | ❌ | When notification was sent (milliseconds) |
| `readFromUserAtMs` | `number` | ❌ | When user read the notification (milliseconds) |
| `detectionDetails` | `object` | ❌ | Additional detection metadata |
| `polymarketSourceEvent` | `object` | ❌ | Raw source event data from Polymarket |

```

#### Example Price Notification

```json
{
  "type": "price_notification",
  "userId": "67d1ac50ff34ab5a5ab571fe",
  "createdAt": "2025-09-30T12:48:14.109Z",
  "watchlistId": "68dbd18b92cd0e76ed506d16",
  "watchlistName": "Test Watchlist",
  "eventId": "32228",
  "eventTitle": "Balance of Power: 2026 Midterms",
  "marketId": "562828",
  "marketQuestion": "2026 Balance of Power: D Senate, D House",
  "polymarketSlug": "balance-of-power-2026-midterms",
  "subscriptionId": "68dbd18c92cd0e76ed506d18",
  "clobTokenId": "34722410608062854697106861099776685947172185964394483545370684749662285977831",
  "subscriptionScope": "Watchlist",
  "subscriptionTypeConfig": {
    "type": "Less Than",
    "config": {
      "params": {
        "threshold_percent": 90
      }
    }
  },
  "triggerType": "One Time",
  "detectedValue": 0.235,
  "detectionDetails": {
    "detectedValue": 0.235,
    "detectedTimeMs": 1759236494109,
    "priceChangeTimeMs": "1759236494020"
  },
  "sentFromPolymarketAtMs": 1759236494020,
  "detectedAt": "2025-09-30T12:48:14.109Z",
  "detectedAtMs": 1759236494109,
  "channels": [
    {
      "type": "Webhook",
      "settings": {
        "webhookUrl": "https://dev-webhook.nevua.markets/webhook"
      }
    }
  ],
  "polymarketSourceEvent": {
    "market": "0x16c63b7cc37f012b9f59ee164ec03877914c701d06d48291ae8d6fc08a088b0d",
    "price_changes": [
      {
        "asset_id": "34722410608062854697106861099776685947172185964394483545370684749662285977831",
        "price": "0.04",
        "size": "0",
        "side": "BUY",
        "hash": "e364191ad922c97239ce0f5ebc20fdabff098c98",
        "best_bid": "0.23",
        "best_ask": "0.24"
      }
    ],
    "timestamp": "1759236494020",
    "event_type": "price_change"
  },
  "_id": "68dbd18ef6ae9b7dfa90d219"
}
```

## Event Status Notification Schema

### `WebhookEventStatusNotificationSchemaJSONRequest`

This schema is used for event and market status change notifications.

#### Properties

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `type` | `"event_status_notification"` | ✅ | The notification type |
| `createdAt` | `string` (ISO 8601) | ✅ | When the notification was created |
| `subscriptionId` | `string` | ✅ | The ID of the subscription that triggered this notification |
| `watchlistId` | `string` | ✅ | The ID of the watchlist being monitored |
| `watchlistName` | `string` | ✅ | The name of the watchlist |
| `eventId` | `string` | ✅ | The Polymarket event ID |
| `eventTitle` | `string` | ✅ | The title of the event |
| `polymarketSlug` | `string` | ✅ | The Polymarket URL slug for this event |
| `eventStatusScope` | `"Market" \| "Event"` | ✅ | Whether this is a market-level or event-level status change |
| `triggerType` | `"Open" \| "Closed"` | ✅ | Whether this is for opening or closing |
| `detectedAt` | `string` (ISO 8601) | ✅ | When the status change was detected |
| `detectedAtMs` | `number` | ✅ | Detection timestamp in milliseconds |
| `marketId` | `string` | ❌ | The market ID (present for market-level changes) |
| `marketQuestion` | `string` | ❌ | The market question (present for market-level changes) |
| `outcomes` | `string` | ❌ | Available outcome options for the market |
| `outcomePrices` | `string` | ❌ | Current prices for market outcomes |
| `sentToUserAtMs` | `number` | ❌ | When notification was sent (milliseconds) |

#### Example Event Status Notifications

**New Event Created**
```json
{
  "type": "event_status_notification",
  "createdAt": "2024-01-15T10:30:00Z",
  "subscriptionId": "507f191e810c19729de860ea",
  "watchlistId": "507f191e810c19729de860eb",
  "watchlistName": "2024 Election Markets",
  "eventId": "0x789...",
  "eventTitle": "2024 Senate Elections",
  "polymarketSlug": "2024-senate-elections",
  "eventStatusScope": "Event",
  "triggerType": "Open",
  "detectedAt": "2024-01-15T10:29:45Z",
  "detectedAtMs": 1705316985000
}
```

**Market Closed**
```json
{
  "type": "event_status_notification",
  "createdAt": "2024-01-15T10:30:00Z",
  "subscriptionId": "507f191e810c19729de860ea",
  "watchlistId": "507f191e810c19729de860eb",
  "watchlistName": "2024 Election Markets",
  "eventId": "0x123...",
  "eventTitle": "2024 Presidential Election",
  "marketId": "0x456...",
  "marketQuestion": "Will Donald Trump win the 2024 Presidential Election?",
  "polymarketSlug": "will-donald-trump-win-the-2024-presidential-election",
  "eventStatusScope": "Market",
  "triggerType": "Closed",
  "outcomes": "Yes,No",
  "outcomePrices": "0.523,0.477",
  "detectedAt": "2024-01-15T10:29:45Z",
  "detectedAtMs": 1705316985000
}
```

## Webhook Delivery

### HTTP Request Format

All webhook notifications are delivered as HTTP POST requests with the following characteristics:

- **Content-Type**: `application/json`
- **User-Agent**: `NevuaMarkets-Webhook/1.0`
- **Body**: JSON payload matching one of the schemas above

### Response Requirements

Your webhook endpoint should:
- Respond with a 2xx HTTP status code to indicate successful receipt
- Respond within 5 seconds to avoid timeout
- Handle duplicate notifications gracefully (notifications may be retried)

### Retry Policy

Failed webhook deliveries will be retried 2 times:
- Retry delay: 1 second
- Maximum retries: 2 retries, 3 attempts in total including the first.

### Security Considerations

- Use HTTPS endpoints for webhook URLs
- Implement signature verification if needed (contact support for details)
- Validate the notification structure before processing
- Consider implementing idempotency based on `subscriptionId` + `detectedAtMs`

## Troubleshooting

### Common Issues

1. **Missing notifications**: Check that your webhook URL is accessible and responding with 2xx status codes
2. **Duplicate notifications**: Implement idempotency handling based on notification IDs
3. **Timeout errors**: Ensure your webhook endpoint responds within 30 seconds

### Testing Your Webhook

You can test your webhook endpoint by creating a test subscription and triggering conditions manually, or by using tools like ngrok for local development.
